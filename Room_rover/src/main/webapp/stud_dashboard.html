<!DOCTYPE html>
<html>
<head>
  <title>Student Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f2f2f2;
      width: 100%;
      height: 100%;
      margin: 0;
      overflow: hidden;
    }

    .header {
      align-items: center;
      padding: 20px;
      background-color: #333;
      color: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
    }

    .footer {
      text-align: center;
      padding: 20px;
      background-color: #333;
      color: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      height: 85px;
    }

    .title {
      display: inline-flex;
      align-items: center;
      margin-left: 30%;
    }

    .profile {
      display: inline-block;
      margin-left: 200px;
    }

    .profile img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid #fff;
    }

    .left {
      display: inline-block;
      width: 750px;
      height: 600px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      margin-left: 100px;
      vertical-align: top; /* Maintain top alignment */
    }

    .leftTitle {
      text-align: center;
    }

    .searchbox {
      margin-left: 10px;
      margin-right: 10px;
    }

    .Title {
      margin-left: 50px;
    }

    .right {
      display: inline-block;
      width: 750px;
      height: 600px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      position: relative;
      border: 1px solid #fff;
      vertical-align: top; /* Maintain top alignment */
    }

    .rightTitle, .rightBottom{
      text-align: center;
    }
    
    .matchingHostelsSection{
		margin-left: 25px;
		height: 250px;
		width: 700px;
		border: 2px solid rgb(0, 14, 0);	
		border-left: none;
		border-right: none;
      position: absolute;
      overflow: auto;
      
	}
	#hostels-table-container {
    max-height: 400px; /* Adjust the maximum height as needed */
    overflow-y: auto;
}

/* Style for the table */
#hostels-table {
	margin-top: 20px;
    width: 100%;
    border-collapse: collapse;
}

/* Style for table header cells */
/* Style for table header cells */
#hostels-table th {
    padding: 12px;
    background-color: #333;
    color: #fff;
    text-align: left;
    position: sticky;
    top: 0;
    z-index: 2;
    white-space: nowrap; /* Add this line to prevent text wrapping */
}


/* Style for table cells */
#hostels-table td {
    padding: 10px;
    border-bottom: 1px solid #ddd;
}

/* Style for the separating line between items */
#hostels-list tr:not(:last-child) {
    border-bottom: 2px solid #ddd;
}



.popup, .popsetting {
      display: none;
    position: fixed;
    top: 49%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 950px;
    height: 600px;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 0;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border: 1px solid #fff;
    z-index: 100;
    position: fixed;
    overflow: hidden;
    }
    .popup-header {
      background-color: #333;
      color: #fff;
      padding: 10px 0;
      text-align: center;
    }
    .popup-header h2 {
      margin: 0;
    }
   .popup-content {
     max-height: 550px;
    overflow-y: auto;
    padding: 20px;
    box-sizing: border-box;
    flex-direction: column;
    align-items: center; /* Center the content horizontally */
    justify-content: center; /* Center the content vertically */
        text-align: center;
}
    .popup-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #333;
    color: #fff;
    text-align: center;
    padding: 10px 0;
    z-index: 1;
}
    .popup-footer button {
      background-color: #333;
      color: #fff;
      border: none;
      cursor: pointer;
      margin: 0 10px;
    }
    .amenities-list {
      list-style: none;
      padding: 0;
      max-height: 200px;
      max-width: 200px;
      overflow-y: auto;
      border: 1px solid rgb(11, 7, 25);
      padding: 5px;
      margin-left: 350px;
    }
    .amenities-list label {
      display: block;
      margin: 2px 0;
      border: 1px solid #ddd;
      padding: 5px;
      font-size: 14px;
    }
    .amenities-list input[type="checkbox"] {
      margin-right: 10px;
      height: 12px;
      width: 12px;
    }
    
    
    .matchingHostelsSection, .yourbookingSection, .paymentssection{
		margin-left: 25px;
		height: 470px;
		width: 700px;
		border: 2px solid rgb(0, 14, 0);	
		border-left: none;
		border-right: none;
		border-top: none;
      position: absolute;
      overflow: auto;
      
	}
	.yourbookingSection{
		margin-top: -20px;
		height: 250px;
		}
	.paymentssection{
		margin-top: -20px;
		height: 202px
	}
		
		
	#hostels-table {
    width: 100%;
    border-collapse: collapse;
}
	    
    
    
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <div class="header">
    <div class="title">
      <div class="Title"><h1>Welcome to Student Dashboard</h1></div>
      <div class="profile">
        <img src="profile_image.jpg" alt="Profile Image">
        <button class="settings-button" onclick="showpopsetting()">
      <i class="fas fa-cog"></i>
    </button>
      </div>
    </div>
  </div>
  
  
  
  <div id="popupsetting" class="popsetting">
	  <input type="hidden" id="pf_complete" name="pf_complete" value="0" />
    <div class="popup-header">
        <h2>Students Details</h2>
    </div>
    <div class="popup-content">
        <!-- Hostel booking form goes here -->
        <label for="studentName">Name: </label>
        <input type="text" id="studentName" name="studentName" readonly ><br><br>

        <label for="studentEmail">Your Email:</label>
        <input type="email" id="studentEmail" name="studentEmail" readonly ><br><br>

        <label for="studaddr">Address:</label>
        <input type="text" id="studaddr" name="studaddr" required><br><br>

        <label for="phone">Phone:</label>
        <input type="text" id="phone" name="phone" readonly ><br><br>

        <label for="aadhar">Aadhar Number:</label>
        <input type="text" id="aadhar" name="aadhar" required><br><br>

        <label for="dob">Date of Birth:</label>
        <input type="date" id="dob" name="dob" readonly ><br><br>

        <label for="gender">Gender:</label>
        <select id="gender" name="gender" required>
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
        </select><br><br>

        <label for="collegeId">College ID:</label>
        <input type="text" id="collegeId" name="collegeId" required><br><br>

        <!-- Add other necessary fields for booking -->

    </div>
    <div class="popup-footer">
        <button id="save" onclick="updateStudDetails()">Save</button>
        <button id="cancel" onclick="closepopsetting()">Cancel</button>
    </div>
</div>


  <div class="left">
    <div class="leftTitle">
      <h2>Search Hostels</h2>
    </div>
    <!-- Add your search form here (search input and button) -->
    <div class="searchbox">
    <input type="text" id="searchInput" placeholder="Search by Hostel Name">
    <select id="locationDropdown" style="width: 150px; margin-right: 10px;">
        <!-- Add an empty option as the default -->
        <option value="">Select Location</option>
        <!-- Other options will be added dynamically using JavaScript -->
    </select>
    <!-- Modify the price dropdown options to include ranges -->
<select id="priceDropdown" style="width: 100px; margin-right: 10px;">
    <option value="">Select Price</option>
    <option value="0-1000">Up to 1000</option>
    <option value="1000-3000">1000 - 3000</option>
    <option value="3000-5000">3000 - 5000</option>
    <option value="5000-8000">5000 - 8000</option>
    <option value="8000-10000">8000 - 10000</option>
    <option value="10000">Above 10000</option>
    <!-- Add more options as needed -->
</select>

    <button onclick="searchHostels()">Search</button>
    <!-- Display the matching hostels in this section of your UI -->
    <div class="matchingHostelsSection">
    <input type="hidden" id="hostelIdforfill" name="hostelId" value="" />
    <table id="hostels-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Location</th>
                <th>Remaining Space</th>
                <th>Room Type</th>
                <th>Price</th>
                <th style="text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody id="hostels-list">
            <!-- Dynamic list items will be added here -->
        </tbody>
    </table>
</div>
<!-- Update the existing HTML form in the book hostel popup section -->
<div id="bookHostelPopup" class="popup">
	<input type="hidden" id="hostelId" name="hostelId" value="" />
    <div class="popup-header">
        <h2>Book Hostel</h2>
    </div>
    <div class="popup-content">
        <!-- Hostel booking form goes here -->
        <label for="hostelName">Hostel Name:</label>
        <input type="text" id="hostelName" name="hostelName" readonly required><br><br>

        <label for="location">Location:</label>
        <input type="text" id="location" name="location" readonly required><br><br>
        
        <label for="address">Address:</label>
        <input type="text" id="address" name="address" readonly required><br><br>

        <label for="landmark">Landmark:</label>
        <input type="text" id="landmark" name="landmark" readonly required><br><br>

        <label for="roomType">Room Type:</label>
        <select id="roomType" name="roomType" disabled required>
            <option value="single">Single</option>
            <option value="2-sharing">2 Sharing</option>
            <option value="3-sharing">3 Sharing</option>
            <option value="4-sharing">4 Sharing</option>
        </select><br><br>
        

        <label for="documents">Documents:</label>
		<button id="viewDocumentButton" onclick="viewDocument()">View Document</button><br><br>

		<label for="bookingDuration">Booking Duration:</label>
		<select id="bookingDuration" name="bookingDuration" required><br><br>
   			 <option value="1-month">1 Month</option>
   			 <option value="3-months">3 Months</option>
   			 <option value="6-months">6 Months</option>
   		 <option value="1-year">1 Year</option>
   		 <!-- Add other duration options as needed -->
		
        <label for="amenities">Amenities:</label>
		<ul class="amenities-list">
  		<li>
  		  <label><input type="checkbox" name="amenities[]" value="wifi" disabled> Wi-Fi</label>
 		 </li>
  		<li>
  		  <label><input type="checkbox" name="amenities[]" value="parking" disabled> Parking</label>
 		 </li>
 		 <li>
 		  <label><input type="checkbox" name="amenities[]" value="ac" disabled> Air Conditioning</label>
 		 </li>
 		 <li>
  		  <label><input type="checkbox" name="amenities[]" value="tv" disabled> TV</label>
 		 </li>
 		 <li>
 		   <label><input type="checkbox" name="amenities[]" value="laundry" disabled> Laundry</label>
 		 </li>
		</ul>

        <label for="price">Price:</label>
        <input type="number" id="price" name="price" readonly required min="0" oninput="validity.valid||(value='');"><br><br>



        <label for="gender">Gender Specific:</label>
        <select id="gender" name="gender" disabled required>
            <option value="boys">Boys</option>
            <option value="girls">Girls</option>
            <option value="both">Both</option>
        </select><br><br>
        
		 <label for="dob">Select Enroll Date</label>
        <input type="date" id="bookStartDate" name="bookStartDate" required ><br><br>
        <!-- Add other necessary fields for booking -->

    </div>
    <div class="popup-footer">
        <button id="confirmBookingButton" onclick="confirmBooking()">Confirm Booking</button>
        <button id="cancelBookingButton" onclick="closeBookHostelPopup()">Cancel</button>
    </div>
</div>




</div>
  </div>
  <div class="right">
    <div class="rightTitle">
      <h2>Your Bookings</h2>
      <div class="yourbookingSection">
    <input type="hidden" id="hostelIdforfill" name="hostelId" value="" />
    <table id="hostels-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Hostel name</th>
                <th>Location</th>
                <th>Room Type</th>
                <th>Hostel ID</th>
                <th>status</th>
                <th>Price</th>
                <th style="text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody id="booking-list">
            <!-- Dynamic list items will be added here -->
        </tbody>
    </table>
</div>
    </div>
    <br><br><br><br><br><br><br><br><br><br><br><br><br>
   <div class="rightBottom">
      <h2>Payments</h2>
      <div class="paymentssection">
   
    <table id="hostels-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Stud Name</th>
                <th>hostel ID</th>
                <th>Hostel name</th>
                <th>owner phone no</th>
                <th>Price</th>
                <th style="text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody id="Payments-list">
            <!-- Dynamic list items will be added here -->
        </tbody>
    </table>
</div>
   </div>
  </div>
  <div class="footer">
    <div class="title">
    </div>
  </div>
  
  <body onload="loadLocations()">
	  
	  
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script>
	  $(document).ready(function () {
       
        fetchStudDetails();
        loadBookings();
    });
    
    
    
 function loadBookings(callback) {
    $.ajax({
        url: 'FetchBooking',
        data: { action: 'student' },
        type: 'POST',
        dataType: 'json',
        success: function (data) {
            // Clear existing table rows
            $('#booking-list').empty();
            $('#payments-list').empty(); // Clear payments table rows

            console.log('Response Data:', data);

            // Iterate over the data and add bookings to the tables
            for (var i = 0; i < data.length; i++) {
                var booking = data[i];
                var bookingRow = $('<tr>');
				var paymentRow =$('<tr>');

                // Add data to the booking table cells
                bookingRow.append('<td>' + booking.booking_id + '</td>');
                bookingRow.append('<td>' + booking.hostel_name + '</td>');
                bookingRow.append('<td>' + booking.location + '</td>');
                bookingRow.append('<td>' + booking.room_type + '</td>');
                bookingRow.append('<td>' + booking.hostel_id + '</td>');
                bookingRow.append('<td>' + booking.status + '</td>');
                bookingRow.append('<td>' + booking.price + '</td>');
                
				if (booking.status === 'accepted, payment pending') 
				{
					paymentRow.append('<td>' + booking.booking_id + '</td>');
                	paymentRow.append('<td>' + booking.student_name + '</td>');
               		 paymentRow.append('<td>' + booking.hostel_id+ '</td>');
                	paymentRow.append('<td>' + booking.hostel_name + '</td>');
                	paymentRow.append('<td>' + booking.phone + '</td>');
               		 paymentRow.append('<td>' + booking.price + '</td>');
				}
                // Add buttons to the booking table
                var bookingActionsCell = $('<td>');					
                if (booking.status === 'pending') 
                {
                    var cancelBookingButton = $('<button>').text('Cancel')
                        .attr('type', 'button')
                        .attr('data-booking-id', booking.booking_id)
                        .click(function () {
                            var bookingId = $(this).data('booking-id');
                            cancelBooking(bookingId);
                        });
                    bookingActionsCell.append(cancelBookingButton);
                } 
                
                
                else if(booking.status === 'accepted, payment pending') 
                {
					var paymentsActionsCell = $('<td>');
                    var viewPaymentsButton = $('<button>').text('Pay')
                        .attr('type', 'button')
                        .attr('data-booking-id', booking.booking_id)
                        .click(function () {
                            var bookingId = $(this).data('booking-id');
                            
                        });
                      paymentsActionsCell.append(viewPaymentsButton);
                }


                bookingActionsCell.css('text-align', 'center');
                bookingRow.append(bookingActionsCell);
                $('#booking-list').append(bookingRow);
                
                if(booking.status === 'accepted, payment pending') 
                {
					paymentsActionsCell.css('text-align', 'center');
					paymentRow.append(paymentsActionsCell);
					$('#Payments-list').append(paymentRow);
				}
  
            }

            if (callback) {
                callback();
            }
        },
        error: function (xhr, status, error) {
            console.error("AJAX Error:", xhr.responseText);
            console.error("Status:", status);
            console.error("Error:", error);
            console.error("URL:", this.url);
        }
    });
}



	
	
	
    
   function fetchStudDetails() {
    $.ajax({
        type: "POST",
        url: "FetchStuddtls",
        data: {
            action: "FetchStuddtls",
        },
        success: function (data) {
            // Parse the JSON data
            var parsedData = JSON.parse(data);

            // Access specific elements
            var studentName = parsedData.student_name;
            var studentEmail = parsedData.email;
            var phone = parsedData.phone;
            var dob = parsedData.dob;
            var pf_complete=parsedData.pf_complete;

            // Set values in your HTML elements
            document.getElementById('studentName').value = studentName;
            document.getElementById('studentEmail').value = studentEmail;
            document.getElementById('phone').value = phone;
            document.getElementById('pf_complete').value=pf_complete;
            
            if(pf_complete>0)
            {
				document.getElementById('studaddr').value=parsedData.addr;
				document.getElementById('gender').value=parsedData.gender;
				
				document.getElementById('collegeId').value=parsedData.college_id;
				document.getElementById('aadhar').value=parsedData.aadhar;
				document.getElementById('aadhar').readOnly = true;
				document.getElementById('gender').disabled = true;
			}
            
            // Parse and format the date
            const dobDate = new Date(dob);
            const formattedDob = `${dobDate.getFullYear()}-${(dobDate.getMonth() + 1).toString().padStart(2, '0')}-${dobDate.getDate().toString().padStart(2, '0')}`;
            document.getElementById('dob').value = formattedDob;
			
			console.log(pf_complete);
            console.log(parsedData);
        },
        // ...
    });
}


	function cancelBooking(bookingId) {
    $.ajax({
        url: 'CancelBooking',
        type: 'POST',
        data: { bookingId: bookingId },
        success: function (data) {
            if (data === "1") {
                // Booking cancelled successfully, show success popup
                alert('Booking cancelled successfully');
            } else {
                // Booking cancellation failed, show error popup or handle as needed
                alert('Booking cancellation failed');
            }
            // Optionally, you can also refresh the booking list here
            loadBookings();
        },
        error: function (xhr, status, error) {
            console.error("AJAX Error:", xhr.responseText);
            console.error("Status:", status);
            console.error("Error:", error);
        }
    });
}

    
    function loadLocations() {
        // Make an AJAX request to GetLocationsServlet with the correct context path
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/Room_rover/GetLocations", true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // Parse the JSON response
                var response = JSON.parse(xhr.responseText);

                // Get the dropdown element
                var locationDropdown = document.getElementById("locationDropdown");

                // Populate the dropdown with locations
                response.locations.forEach(function (location) {
                    var option = document.createElement("option");
                    option.value = location;
                    option.text = location;
                    locationDropdown.add(option);
                });
            }
        };
        xhr.send();
    }
    
    
    
    // Function to handle the search for hostels
    function searchHostels() {
        var searchInput = document.getElementById("searchInput").value;
        var selectedLocation = document.getElementById("locationDropdown").value;
        var selectedPrice = document.getElementById("priceDropdown").value;

        // Make an AJAX request to a servlet to get matching hostels based on search criteria
        var xhr = new XMLHttpRequest();
        var url = "/Room_rover/SearchHostelsServlet?searchInput=" + searchInput +
            "&location=" + selectedLocation + "&price=" + selectedPrice;
        xhr.open("POST", url, true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // Parse the JSON response
                var response = JSON.parse(xhr.responseText);

                // Update the UI with the matching hostels
                displayMatchingHostels(response);
            }
        };
        xhr.send();
    }
    
    
    
var currentHostelId = null;    
    
    // Function to display matching hostels in the UI
    // Function to display matching hostels in the UI
function displayMatchingHostels(hostels) {
    var hostelsList = document.getElementById("hostels-list");

    // Clear previous results
    hostelsList.innerHTML = "";

    // Check if there are matching hostels
    if (hostels.length > 0) {
        // Create rows for each hostel
        for (var i = 0; i < hostels.length; i++) {
            var hostel = hostels[i];
            var row = hostelsList.insertRow(-1);

            // Insert data cells
            var idCell = row.insertCell(0);
            idCell.innerHTML = hostel.hostelId;

            var nameCell = row.insertCell(1);
            nameCell.innerHTML = hostel.hostelName;

            var locationCell = row.insertCell(2);
            locationCell.innerHTML = hostel.location;

            var remainingSpaceCell = row.insertCell(3);
            remainingSpaceCell.innerHTML = hostel.remainingSpace;

            var roomTypeCell = row.insertCell(4);
            roomTypeCell.innerHTML = hostel.roomType;

            var priceCell = row.insertCell(5);
            priceCell.innerHTML = hostel.price;

           
            var actionsCell = row.insertCell(6);
                  // Add "Book" button
                  var bookButton = document.createElement("button");
        bookButton.innerHTML = "Book";

        // Create a function to handle the click event with the captured hostelId
        function bookButtonClickHandler(id) {
            return function () {
				
				currentHostelId = id;
                // Call a function to handle booking for this hostel
                showBookHostelPopup();
				
                // Call the retrieveHostel function with the captured hostel ID
                retrieveHostel(id);
                
            };
        }

        // Get the hostel ID associated with this button
        var hostelId = hostel.hostelId;

        // Attach the function to the onclick event
        bookButton.onclick = bookButtonClickHandler(hostelId);
		
        actionsCell.appendChild(bookButton);
        // Add actions content here if needed
       
    }
    } else {
        // Display a message if no matching hostels found
        hostelsList.innerHTML = "<tr><td colspan='7'>No matching hostels found.</td></tr>";
    }
}






function retrieveHostel(hostelId){
	console.log("lol ID="+hostelId);
	document.getElementById('hostelId').value=hostelId;
	//console.log("new lil ID="+document.getElementById('hostelId').value);
	
	$.ajax({
        type: "POST",
        url: "Prefill",
        data: {
            action: "Prefill",
            hostelIdToPrefill: hostelId
        },
        success: function (data) {
            console.log("Response Data:", data);
            try {
                // Assuming the servlet returns JSON data
                // Directly access the properties of the data object
                var hostel = data;

                // Set the values in the form fields for prefilling
                document.getElementById('hostelName').value = hostel.hostelName;
                document.getElementById('location').value = hostel.location;
                document.getElementById('price').value = hostel.price;
                document.getElementById('roomType').value = hostel.roomType;
                
                
                document.getElementById('address').value = hostel.address;
                document.getElementById('landmark').value = hostel.landmark;
                
				document.getElementById('gender').value = hostel.gender;

               
				var amenities = hostel.amenitiesString.split(", ");
                amenities.forEach(function (amenity) {
                    $('input[name="amenities[]"][value="' + amenity + '"]').prop('checked', true);
                });


                // Load the document path and set it in the file input field
                var documentPath = hostel.documentPath;
                if (documentPath) {
                    // Replace the existing file input if it exists
                    var existingFileInput = document.getElementById('documents');
                    if (existingFileInput) {
                        // Create a new file input element
                        var newFileInput = document.createElement('input');
                        newFileInput.type = 'file';
                        newFileInput.id = 'documents';

                        // Replace the existing file input with the new one
                        existingFileInput.parentNode.replaceChild(newFileInput, existingFileInput);

                        // Show the view button
                        document.getElementById('viewDocumentButton').style.display = "inline";
                    } else {
                        console.error("Existing file input not found.");
                    }
                }
                // Check and set amenities checkboxes
                
				
                // Show the popup
                showBookHostelPopup();
            } catch (error) {
                console.error("Error parsing JSON:", error);
            }
        },
        
        error: function (xhr, status, error) {
            console.error("Error fetching data:", error);
        }
    });
}



function updateStudDetails() {
    // Collect the data from the HTML form
    var studaddr = document.getElementById('studaddr').value;
    var aadhar = document.getElementById('aadhar').value;
    var gender = document.getElementById('gender').value;
    var collegeid = document.getElementById('collegeId').value;

    // Prepare the data to be sent to the server
    var data = {
        action: "UpdateStudDetails",
        studaddr: studaddr,
        aadhar: aadhar,
        gender: gender,
        collegeid: collegeid
    };

    // Make an AJAX request to the server
    $.ajax({
        type: "POST",
        url: "UpdateStudDetailsServlet", // Replace with the actual URL of your servlet
        data: data,
        success: function (response) {
            // Handle the response from the server (if needed)
            console.log(response);
		if (response.trim() === "1") {
            // Show a success popup message
            window.alert("Updated successfully!");
            closepopsetting();
            fetchStudDetails();
        } else {
            // Handle other cases if needed
            // You might want to show an error message or take additional actions
            console.error("Error updating student details. Response:", response);
        }
        },
        error: function (error) {
            // Handle errors (if any)
            console.error("Error updating student details:", error);
        }
    });
}



function Booking() {
    // Collect data from the HTML form
    console.log("currentHostelId="+currentHostelId);
    var hostelId = currentHostelId;
    var bookingTime = new Date();// Current time
    var startDate = document.getElementById('bookStartDate').value;
    var bookingDuration = document.getElementById('bookingDuration').value;
    var price=document.getElementById('price').value;

    // Calculate end date based on start date and booking duration
    var bookingDurationDropdown = document.getElementById('bookingDuration');
    var selectedBookingDuration = bookingDurationDropdown.options[bookingDurationDropdown.selectedIndex].value;

    // Calculate end date based on start date and selected booking duration
    var endDate = new Date(startDate);

    switch (selectedBookingDuration) {
        case '1-month':
            endDate.setMonth(endDate.getMonth() + 1);
            break;
        case '3-months':
            endDate.setMonth(endDate.getMonth() + 3);
            break;
        case '6-months':
            endDate.setMonth(endDate.getMonth() + 6);
            break;
        case '1-year':
            endDate.setFullYear(endDate.getFullYear() + 1);
            break;
        default:
            // Handle unknown duration
            console.error('Unknown booking duration:', selectedBookingDuration);
            return;
    }

    // Prepare the data to be sent to the server
    var data = {
        action: "BookHostelServlet",
        hostelId: hostelId,
        bookingTime: bookingTime,
        bookingDuration: bookingDuration,
        startDate: startDate,
        endDate: endDate,
        price: price
    };

    // Make an AJAX request to the server
    $.ajax({
        type: "POST",
        url: "BookHostelServlet", // Replace with the actual URL of your servlet
        data: data,
        success: function (response) {
            console.log(response);
            if(response>0)
            {
			window.alert("Booking Request sent successfully");
			closeBookHostelPopup();
			}
        },
        error: function (error) {
            console.error("Error booking room:", error);
        }
    });
}




function showBookHostelPopup() {
        var popup = document.getElementById("bookHostelPopup");
        popup.style.display = "block";
    }

    function closeBookHostelPopup() {
        var popup = document.getElementById("bookHostelPopup");
        popup.style.display = "none";
    }
   function showpopsetting() {
        var popup = document.getElementById("popupsetting");
        popup.style.display = "block";
        fetchStudDetails();
    }

    function closepopsetting() {
        var popup = document.getElementById("popupsetting");
        popup.style.display = "none";
    }

    function confirmBooking() {
        if (document.getElementById('pf_complete').value == 0)
         {
        // Show a popup message to the user
        window.alert("Profile is not complete. Please complete your profile from the settings icon at the header.");
        return; // Stop further execution if the profile is not complete
   		 }
   		  window.alert("in the booking");
   		  
          Booking();
         
    }
</script>
  
  
</body>
</html>
