<!DOCTYPE html>
<html>
<head>
  <title>Student Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f2f2f2;
      width: 100%;
      height: 100%;
      margin: 0;
      overflow: hidden;
    }

    .header {
      align-items: center;
      padding: 20px;
      background-color: #333;
      color: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
    }

    .footer {
      text-align: center;
      padding: 20px;
      background-color: #333;
      color: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      height: 85px;
    }

    .title {
      display: inline-flex;
      align-items: center;
      margin-left: 30%;
    }

    .profile {
      display: inline-block;
      margin-left: 200px;
    }

    .profile img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid #fff;
    }

    .left {
      display: inline-block;
      width: 750px;
      height: 600px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      margin-left: 100px;
      vertical-align: top; /* Maintain top alignment */
    }

    .leftTitle {
      text-align: center;
    }

    .searchbox {
      margin-left: 100px;
    }

    .Title {
      margin-left: 50px;
    }

    .right {
      display: inline-block;
      width: 750px;
      height: 600px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      position: relative;
      border: 1px solid #fff;
      vertical-align: top; /* Maintain top alignment */
    }

    .rightTitle {
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="title">
      <div class="Title"><h1>Welcome to Student Dashboard</h1></div>
      <div class="profile">
        <img src="profile_image.jpg" alt="Profile Image">
      </div>
    </div>
  </div>
  <div class="left">
    <div class="leftTitle">
      <h2>Search Hostels</h2>
    </div>
    <!-- Add your search form here (search input and button) -->
    <div class="searchbox">
    <input type="text" id="searchInput" placeholder="Search by Hostel Name">
    <select id="locationDropdown" style="width: 150px; margin-right: 10px;">
        <!-- Add an empty option as the default -->
        <option value="">Select Location</option>
        <!-- Other options will be added dynamically using JavaScript -->
    </select>
    <!-- Modify the price dropdown options to include ranges -->
<select id="priceDropdown" style="width: 100px; margin-right: 10px;">
    <option value="">Select Price</option>
    <option value="0-1000">Up to 1000</option>
    <option value="1000-3000">1000 - 3000</option>
    <option value="3000-5000">3000 - 5000</option>
    <option value="5000-8000">5000 - 8000</option>
    <option value="8000-10000">8000 - 10000</option>
    <option value="10000">Above 10000</option>
    <!-- Add more options as needed -->
</select>

    <button onclick="searchHostels()">Search</button>
    <!-- Display the matching hostels in this section of your UI -->
    <div id="matchingHostelsSection"></div>
</div>
  </div>
  <div class="right">
    <div class="rightTitle">
      <h2>Your Bookings</h2>
    </div>
    <!-- Add your booking requests here -->
  </div>
  <div class="footer">
    <div class="title">
    </div>
  </div>
  
  <body onload="loadLocations()">
  
  <script>
    function loadLocations() {
        // Make an AJAX request to GetLocationsServlet with the correct context path
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/Room_rover/GetLocations", true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // Parse the JSON response
                var response = JSON.parse(xhr.responseText);

                // Get the dropdown element
                var locationDropdown = document.getElementById("locationDropdown");

                // Populate the dropdown with locations
                response.locations.forEach(function (location) {
                    var option = document.createElement("option");
                    option.value = location;
                    option.text = location;
                    locationDropdown.add(option);
                });
            }
        };
        xhr.send();
    }
    
    
    
    // Function to handle the search for hostels
    function searchHostels() {
        var searchInput = document.getElementById("searchInput").value;
        var selectedLocation = document.getElementById("locationDropdown").value;
        var selectedPrice = document.getElementById("priceDropdown").value;

        // Make an AJAX request to a servlet to get matching hostels based on search criteria
        var xhr = new XMLHttpRequest();
        var url = "/Room_rover/SearchHostelsServlet?searchInput=" + searchInput +
            "&location=" + selectedLocation + "&price=" + selectedPrice;
        xhr.open("POST", url, true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // Parse the JSON response
                var response = JSON.parse(xhr.responseText);

                // Update the UI with the matching hostels
                displayMatchingHostels(response);
            }
        };
        xhr.send();
    }
    
    
    // Function to display matching hostels in the UI
    function displayMatchingHostels(hostels) {
        var matchingHostelsSection = document.getElementById("matchingHostelsSection");

        // Clear previous results
        matchingHostelsSection.innerHTML = "";

        // Check if there are matching hostels
        if (hostels.length > 0) {
            // Create a table to display hostels
            var table = document.createElement("table");
            table.border = "1";

            // Create header row
            var headerRow = table.insertRow(0);
            var headers = ["Hostel Name", "Location", "Price"];
            for (var i = 0; i < headers.length; i++) {
                var headerCell = headerRow.insertCell(i);
                headerCell.innerHTML = headers[i];
            }

            // Create rows for each hostel
            for (var i = 0; i < hostels.length; i++) {
                var hostel = hostels[i];
                var row = table.insertRow(i + 1);

                // Insert data cells
                var nameCell = row.insertCell(0);
                nameCell.innerHTML = hostel.hostelName;

                var locationCell = row.insertCell(1);
                locationCell.innerHTML = hostel.location;

                var priceCell = row.insertCell(2);
                priceCell.innerHTML = hostel.price;
            }

            // Append the table to the matchingHostelsSection
            matchingHostelsSection.appendChild(table);
        } else {
            // Display a message if no matching hostels found
            matchingHostelsSection.innerHTML = "<p>No matching hostels found.</p>";
        }
    }
</script>
  
  
</body>
</html>
